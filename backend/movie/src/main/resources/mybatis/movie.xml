<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.movie.repository.MovieMapper">
  <!-- ========================= -->
  <!-- EXISTS: 중복 확인 쿼리 -->
  <!-- ========================= -->

  <select id="existsGenre" resultType="boolean">
      SELECT EXISTS (
          SELECT 1 FROM GENRE WHERE GENRE_CODE = #{genreCode}
      )
  </select>

  <select id="existsCreator" resultType="boolean">
      SELECT EXISTS (
          SELECT 1 FROM CREATOR WHERE CREATOR_CODE = #{creatorCode}
      )
  </select>

  <select id="existsMovie" resultType="boolean">
      SELECT EXISTS (
          SELECT 1 FROM MOVIE WHERE MOVIE_CODE = #{movieCode}
      )
  </select>

  <!-- ========================= -->
  <!-- INSERT: 데이터 삽입 쿼리 -->
  <!-- ========================= -->

  <insert id="batchInsertGenre">
      INSERT INTO GENRE (
          GENRE_CODE,
          GENRE_NAME
      ) VALUES (
          #{genreCode},
          #{genreName}
      )
  </insert>

  <insert id="batchInsertCreator">
      INSERT INTO CREATOR (
          CREATOR_CODE,
          CREATOR_NAME,
          GENDER
      ) VALUES (
          #{creatorCode},
          #{creatorName},
          #{gender}
      )
  </insert>

  <insert id="batchInsertMovie">
      INSERT INTO MOVIE (
          MOVIE_CODE,
          GENRE_CODEA,
          GENRE_CODEB,
          GENRE_CODEC,
          MOVIE_NAME,
          DIRECT_CODEA,
          DIRECT_CODEB,
          ACTOR_CODEA,
          ACTOR_CODEB,
          ACTOR_CODEC,
          ACTOR_CODED,
          ACTOR_CODEE,
          SYNOPSIS,
          RUNTIME,
          RATING_TPCD,
          MOVIE_RELEASE,
          TEASER,
          POSTER,
          BACKGROUND,
          SALES
      ) VALUES (
          #{movieCode},
          #{genreCodeA},
          #{genreCodeB},
          #{genreCodeC},
          #{movieName},
          #{directCodeA},
          #{directCodeB},
          #{actorCodeA},
          #{actorCodeB},
          #{actorCodeC},
          #{actorCodeD},
          #{actorCodeE},
          #{synopsis},
          #{runtime},
          #{ratingTpcd},
          #{movieRelease},
          #{teaser},
          #{poster},
          #{background},
          #{sales}
      )
  </insert>
</mapper>